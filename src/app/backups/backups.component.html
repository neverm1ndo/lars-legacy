<div class="playerlog h-100 nopadding d-flex flex-column flex-fill align-self-stretch">
  <div class="wrapper-main overflow-auto d-flex align-items-stretch flex-fill">
    <div class="col-12 h-100">
      <div class="row h-100">
        <div class="col-md-8 col-lg-9 col-xl-9 h-100">
          <div class="row h-100">
            <div class="d-flex flex-column h-100 w-100">
              <div class="d-flex align-self-start head w-100">
                <div class="col-12">
                  <div class="row">
                    <div class="col-12">
                      <h1 class="mt-4 mb-4">Раздел резервных копий</h1>
                      <p>ВНИМАНИЕ: Удаление и перезапись бэкапов может привести к безвозвратному удалению данных с рабочего игрового сервера</p>
                    </div>
                  </div>
                </div>
              </div>
              <div class="d-flex h-100 flex-row overflow-auto pl-2">
                <div #binds class="binds"></div>
                <div #backupsList  class="d-flex flex-column backups-list w-100 pr-2">
                  <app-backup-item *ngFor="let backup of backups" [attr.data-filename]="backup.file.name" [backup-info]="backup" (currentToView)="current = $event"></app-backup-item>
                  <div *ngIf="backups.length == 0 && !loading" class="d-flex flex-fill justify-content-center align-items-center">
                    <p class="text-muted">Нет живых бэкапов</p>
                  </div>
                  <div *ngIf="backups.length == 0 && loading" class="d-flex flex-fill justify-content-center align-items-center">
                    <lty-icon name="lty-logo" anim="spinner-logo"></lty-icon>
                  </div>
                </div>
              </div>
              <div *ngIf="current" class="d-flex h-100 flex-column viewer">
                <div class="d-flex flex-row justify-content-between viewer-head align-items-center">
                  <div class="d-flex align-items-center">
                    <button (click)="current = undefined" class="btn btn-dark viewer-hide" type="button" name="button"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" preserveAspectRatio="xMidYMid meet" viewBox="0 0 30 30" width="30" height="30"><defs><path d="M24.69 9.83L14.66 20.77L4.69 9.83" id="a1sXzGPVRt"></path></defs><g><g><g><g><use xlink:href="#a1sXzGPVRt" opacity="1" fill-opacity="0" stroke-width="1" stroke-opacity="1"></use></g></g></g></g></svg></button>
                    <span class=""><i [style.background]="colorGenerator([current.file.name])[0]"></i>{{current.file.name}}</span>
                    <div class="pl-3 d-flex flex-column">
                      <small class="text-muted elapse">{{current.date | date:'d MMM yy, HH:mm:ss'}}</small>
                      <small class=" elapse">{{current.file.path}}</small>
                    </div>
                  </div>
                  <div class="d-flex align-items-center">
                    <button class="btn btn-success ml-2" type="button" name="button">Установить</button>
                  </div>
                </div>
                <div class="d-flex flex-fill viewer-code overflow-auto">
                  <pre class="w-100">{{current.file.text}}</pre>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="col-md-4 col-lg-3 col-xl-3 h-100 history">
          <div class="row h-100">
            <div class="d-flex flex-column h-100 w-100">
              <div class="w-100 d-flex align-self-start align-items-center justify-content-center">
                <div class="p-3 history-head w-100 text-center">
                  <span>История изменений файлов</span>
                </div>
              </div>
              <div class="d-flex flex-fill flex-column overflow-auto">
                <div class="d-flex flex-row changes-card justify-content-between" *ngFor="let change of backups">
                  <div class="d-flex align-self-start">
                    <span>
                      <strong>{{change.user.nickname}}</strong><i> {{ actions[change.action] }} файл</i><span> {{change.file.name}}</span>
                    </span>
                  </div>
                  <div class="d-flex align-self-center changes-card-date">
                    <div class="d-flex">
                      <small class=text-muted>
                        {{ change.date | date:'d MMM yy, HH:mm:ss' }}
                      </small>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
